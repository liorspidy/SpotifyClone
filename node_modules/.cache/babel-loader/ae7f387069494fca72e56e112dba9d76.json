{"ast":null,"code":"import _slicedToArray from\"C:/Users/liors/Documents/Code Projects/JS/ReactProject/spotify-clone/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import'./App.css';import Header from'./Header/Header';import Main from'./sidebar/Main';import DefaultPage from'./pages/DefaultPage';import{useContext,useEffect,useState}from'react';import{getTokenFromUri}from'./Login';import SpotifyWebApi from'spotify-web-api-js';import DataLayerContext from'./store/DataLayerContext';import Footer from'./footer/Footer';import Search from'./pages/Search';import CloneWelcome from'./pages/CloneWelcome';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var spotify=new SpotifyWebApi();var App=function App(){var ctx=useContext(DataLayerContext);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isSearchPressed=_useState2[0],setIsSearchPressed=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),currentTrack=_useState4[0],setCurrentTrack=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),categories=_useState6[0],setCategories=_useState6[1];useEffect(function(){var getSpotifyData=function getSpotifyData(tokenData){spotify.setAccessToken(tokenData);spotify.getMe().then(function(user){return ctx.loginUser(user);}).catch(function(error){return console.log(error.message);});spotify.getUserPlaylists().then(function(playlists){return ctx.addToPlaylist(playlists);}).catch(function(error){return console.log(error.message);});spotify.getMyCurrentPlayingTrack().then(function(res){return setCurrentTrack(res);}).catch(function(error){return console.log(error.message);});spotify.getCategories().then(function(res){setCategories(res.categories.items);}).catch(function(error){return console.log(error.message);});};var hash=getTokenFromUri();window.location.hash='';var received_token=hash.access_token;if(received_token){ctx.setToken(received_token);getSpotifyData(received_token);}},[ctx]);useEffect(function(){categories.forEach(function(cat){spotify.getCategoryPlaylists(cat.id).then(function(res){cat.image=res.playlists.items[0].images[0].url;}).catch(function(error){return console.log(error.message);});});},[categories]);return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"notFooter\",children:[/*#__PURE__*/_jsx(Main,{onSearch:setIsSearchPressed,isSearchPressed:isSearchPressed}),/*#__PURE__*/_jsxs(\"div\",{className:\"mainPages\",children:[/*#__PURE__*/_jsx(Header,{isSearchPressed:isSearchPressed}),!ctx.token&&/*#__PURE__*/_jsx(CloneWelcome,{}),!isSearchPressed&&ctx.token&&/*#__PURE__*/_jsx(DefaultPage,{}),isSearchPressed&&ctx.token&&/*#__PURE__*/_jsx(Search,{setCategories:setCategories,categories:categories})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"footer\",children:/*#__PURE__*/_jsx(Footer,{currentTrack:currentTrack})})]});};export default App;","map":{"version":3,"names":["Header","Main","DefaultPage","useContext","useEffect","useState","getTokenFromUri","SpotifyWebApi","DataLayerContext","Footer","Search","CloneWelcome","spotify","App","ctx","isSearchPressed","setIsSearchPressed","currentTrack","setCurrentTrack","categories","setCategories","getSpotifyData","tokenData","setAccessToken","getMe","then","user","loginUser","catch","error","console","log","message","getUserPlaylists","playlists","addToPlaylist","getMyCurrentPlayingTrack","res","getCategories","items","hash","window","location","received_token","access_token","setToken","forEach","cat","getCategoryPlaylists","id","image","images","url","token"],"sources":["C:/Users/liors/Documents/Code Projects/JS/ReactProject/spotify-clone/src/App.js"],"sourcesContent":["import './App.css';\nimport Header from './Header/Header';\nimport Main from './sidebar/Main';\nimport DefaultPage from './pages/DefaultPage';\nimport { useContext, useEffect, useState } from 'react';\nimport { getTokenFromUri } from './Login';\nimport SpotifyWebApi from 'spotify-web-api-js';\nimport DataLayerContext from './store/DataLayerContext';\nimport Footer from './footer/Footer';\nimport Search from './pages/Search';\nimport CloneWelcome from './pages/CloneWelcome';\n\nconst spotify = new SpotifyWebApi();\n\nconst App = () => {\n  const ctx = useContext(DataLayerContext);\n  const [isSearchPressed, setIsSearchPressed] = useState(false);\n  const [currentTrack, setCurrentTrack] = useState({});\n  const [categories, setCategories] = useState([]);\n\n  useEffect(() => {\n    const getSpotifyData = (tokenData) => {\n      spotify.setAccessToken(tokenData);\n      spotify\n        .getMe()\n        .then((user) => ctx.loginUser(user))\n        .catch((error) => console.log(error.message));\n      spotify\n        .getUserPlaylists()\n        .then((playlists) => ctx.addToPlaylist(playlists))\n        .catch((error) => console.log(error.message));\n\n      spotify\n        .getMyCurrentPlayingTrack()\n        .then((res) => setCurrentTrack(res))\n        .catch((error) => console.log(error.message));\n\n      spotify\n        .getCategories()\n        .then((res) => {\n          setCategories(res.categories.items);\n        })\n        .catch((error) => console.log(error.message));\n    };\n\n    const hash = getTokenFromUri();\n    window.location.hash = '';\n    const received_token = hash.access_token;\n    if (received_token) {\n      ctx.setToken(received_token);\n      getSpotifyData(received_token);\n    }\n  }, [ctx]);\n\n  useEffect(() => {\n    categories.forEach((cat) => {\n      spotify\n        .getCategoryPlaylists(cat.id)\n        .then((res) => {\n          cat.image = res.playlists.items[0].images[0].url;\n        })\n        .catch((error) => console.log(error.message));\n    });\n  }, [categories]);\n\n  return (\n    <div className=\"App\">\n      <div className=\"notFooter\">\n        <Main onSearch={setIsSearchPressed} isSearchPressed={isSearchPressed} />\n        <div className=\"mainPages\">\n          <Header isSearchPressed={isSearchPressed} />\n          {!ctx.token && <CloneWelcome />}\n          {!isSearchPressed && ctx.token && <DefaultPage />}\n          {isSearchPressed && ctx.token && (\n            <Search setCategories={setCategories} categories={categories} />\n          )}\n        </div>\n      </div>\n      <div className=\"footer\">\n        <Footer currentTrack={currentTrack} />\n      </div>\n    </div>\n  );\n};\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}